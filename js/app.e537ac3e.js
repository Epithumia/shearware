(function(e){function t(t){for(var r,i,o=t[0],l=t[1],c=t[2],p=0,d=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},s=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/shearware/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"2c71":function(e,t,a){"use strict";a("57c1")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("h1",{staticClass:"title center text-4xl"},[e._v(" Bienvenue sur la tondeuse à Sheep ")]),a("br"),a("text-reader",{on:{load:function(t){e.text=t}}}),a("shearing")],1)},s=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{staticClass:"text-reader hover:bg-green-50"},[e._v(" Charger le fichier CSV du field "),a("input",{directives:[{name:"shortkey",rawName:"v-shortkey",value:{win:["ctrl","o"],mac:["meta","o"]},expression:"{win:['ctrl', 'o'], mac:['meta', 'o']}"}],ref:"fileSelect",attrs:{type:"file",accept:"text/csv"},on:{change:e.loadTextFromFile,shortkey:e.buttonClicked}})])},o=[],l=a("b85c"),c=(a("4de4"),a("d3b7"),a("ac1f"),a("00b4"),a("d81d"),a("caad"),a("2532"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("2f62")),u=a("0e44"),p=a("53f4"),d="loadCSV",f="remap",m="remap";r["a"].use(c["a"]);var v={data:[],fields:[],questions:[],errors:[],mappings:[]},h={loadCSV:function(e,t){e.commit(d,t)},map:function(e,t){e.commit(f,t)},remap:function(e,t){e.commit(m,t)}},b={map:function(e,t){if(t.row>-1)e.mappings[t.question][t.row].mapped=t.after;else{var a,r=Object(l["a"])(e.mappings[t.question]);try{for(r.s();!(a=r.n()).done;){var n=a.value;n.answer===t.before&&(n.mapped=t.after)}}catch(s){r.e(s)}finally{r.f()}}return e.mappings},remap:function(e,t){if(t.row>-1)e.mappings[t.question][t.row].mapped=t.after;else{var a,r=Object(l["a"])(e.mappings[t.question]);try{for(r.s();!(a=r.n()).done;){var n=a.value;n.mapped===t.before&&(n.mapped=t.after)}}catch(s){r.e(s)}finally{r.f()}}return e.mappings},loadCSV:function(e,t){if(t.errors.length>0)return e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=t["errors"];Array.prototype.findRex=function(e){var t=this,a=t.filter((function(t){return e.test(t)}));return a.map((function(e){return t.indexOf(e)}))},Array.prototype.findQuestions=function(e){var t=this,a=t.filter((function(t){return!e.test(t)}));return a.map((function(e){return e}))};var a=t.meta.fields;if(!a.includes("Timestamp"))return e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=["Fichier CSV non valide : colonne timestamp manquante"];if(!a.includes("Email Address"))return e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=["Fichier CSV non valide : colonne email manquante"];var r=new RegExp("JeuSheep"),n=a.findRex(r);if(!n.length)return e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=["Fichier CSV non valide : colonne twitter manquante"];n=new RegExp("(Timestamp)|(Email Address)|.*JeuSheep.*");var s=a.findQuestions(n);if(0===n.length)return e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=["Fichier CSV non valide : il  n'y a pas de question"];e.errors=[],e.fields=a,e.questions=s;var i,o=[],c=t.data,u=new RegExp("JeuSheep");n=a.findRex(u);var p,d=Object(l["a"])(s);try{for(d.s();!(p=d.n()).done;){var f=p.value;i=0;var m,v=[],h=Object(l["a"])(c);try{for(h.s();!(m=h.n()).done;){var b=m.value,y={id:i,twitter:b[a[n]],email:b["Email Address"],answer:b[f],mapped:b[f]};i++,v.push(y)}}catch(g){h.e(g)}finally{h.f()}o.push(v)}}catch(g){d.e(g)}finally{d.f()}return e.mappings=o,e.data=t.data},emptyState:function(e){e.data=[],e.fields=[],e.questions=[],e.mappings=[],e.errors=[]}},y=new c["a"].Store(Object(p["b"])({state:v,actions:h,mutations:b,plugins:[Object(p["a"])(),Object(u["a"])()]})),g={methods:{loadTextFromFile:function(e){var t=this,a=e.target.files[0],r=new FileReader;r.onload=function(e){t.$emit("load",e.target.result);var a=t.$papa.parse(e.target.result,{header:!0,skipEmptyLines:!0});y.dispatch(d,a)},r.readAsText(a)},buttonClicked:function(){var e="fileSelect";console.log("ref: ",e);var t=this.$refs[e];console.log("element",t),t.click()}}},x=g,w=(a("b4fa"),a("2877")),_=Object(w["a"])(x,i,o,!1,null,null,null),C=_.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"shearing"},[a("div",{staticClass:"notification"},[a("div",[a("button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:{win:["ctrl","z"],mac:["meta","z"]},expression:"{win:['ctrl', 'z'], mac:['meta', 'z']}"}],staticClass:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",on:{click:e.undo,shortkey:e.undo}},[e._v(" Annuler ")]),a("button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:{win:["ctrl","y"],mac:["meta","y"]},expression:"{win:['ctrl', 'y'], mac:['meta', 'y']}"}],staticClass:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",on:{click:e.redo,shortkey:e.redo}},[e._v(" Rétablir ")]),a("button",{staticClass:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",on:{click:e.clear}},[e._v(" RAZ ")])]),a("div",{staticClass:"grid grid-cols-6"},[a("div",{staticClass:"col-span-4"},[a("te-tabs",{attrs:{titles:e.questions}},[e._l(e.questions,(function(t,r){return a("template",{slot:"tab-"+(r+1)},[a("te-tabs",{key:r,attrs:{titles:["Scores question","Blocs de réponses","Réponses individuelles"]}},[a("template",{slot:"tab-1"},[a("h3",[e._v(e._s(t))]),e._l(e.getScoresByAnswer(r),(function(t){return a("div",{key:t[0]},[a("hr"),a("h3",[e._v(e._s(t[0])+" -- "+e._s("Disqualifié"===t[0]?0:t[1].length)+" points")]),a("hr"),e._l(t[1],(function(t){return a("p",{key:t.email+t.twitter},[e._v(" "+e._s(t.twitter)+" ")])})),a("hr")],2)}))],2),a("template",{slot:"tab-2"},[a("table",{staticClass:"min-w-full text-center"},[a("thead",{staticClass:"border-b bg-white"},[a("tr",[a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Nb réponses ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Réponse enregistrée ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Transformer en ")])])]),a("tbody",e._l(e.getGroupedRemaps(r),(function(t,n){return a("tr",{key:n,staticClass:"border-b",class:{"bg-white":n%2,"bg-gray-100":(n+1)%2}},[a("td",{staticClass:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900"},[e._v(" "+e._s(t["count"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[e._v(" "+e._s(t["mapped"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[a("te-select",{ref:"sel-"+r+"-"+n,refInFor:!0,attrs:{options:e.getDistinctAnswers(r),placeholder:t["mapped"],"value-field":"answer","display-field":"answer"},on:{input:function(a){return e.remap(t["mapped"],a,r,-1)}}})],1)])})),0)])]),a("template",{slot:"tab-3"},[a("table",{staticClass:"min-w-full text-center"},[a("thead",{staticClass:"border-b bg-white"},[a("tr",[a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" # ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Email ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Twitter ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Réponse ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Réponse enregistrée ")]),a("th",{staticClass:"text-sm font-medium text-gray-900 px-6 py-2",attrs:{scope:"col"}},[e._v(" Choix ")])])]),a("tbody",e._l(e.mappings[r],(function(t,n){return a("tr",{key:n,staticClass:"border-b",class:{"bg-white":n%2,"bg-gray-100":(n+1)%2}},[a("td",{staticClass:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900"},[e._v(e._s(t["id"]))]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[e._v(" "+e._s(t["email"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[e._v(" "+e._s(t["twitter"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[e._v(" "+e._s(t["answer"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[e._v(" "+e._s(t["mapped"])+" ")]),a("td",{staticClass:"text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap"},[a("te-select",{ref:"ind-sel-"+r+"-"+n,refInFor:!0,attrs:{options:e.getDistinctAnswers(r),placeholder:t["mapped"],"value-field":"answer","display-field":"answer"},on:{input:function(a){return e.remap(t["mapped"],a,r,t["id"])}}})],1)])})),0)])])],2)],1)}))],2)],1),a("div",{staticClass:"col-span-2"},[a("h2",[e._v("Scores cumulés jusqu'à la question :")]),a("te-select",{attrs:{options:Array.from(Array(this.questions.length).keys()).map((function(e){return e+1}))},model:{value:e.cutoff,callback:function(t){e.cutoff=t},expression:"cutoff"}}),e._l(e.getScoresByUser(e.cutoff),(function(t,r){return a("p",{key:r},[e._v(" "+e._s(r+1)+" - "+e._s(t.twitter)+" : "+e._s(t.score)+" ")])}))],2)])])])},j=[],k=a("2909"),S=a("ade3"),q=a("3835"),R=a("5530"),V=(a("b64b"),a("4e82"),a("4fad"),a("4ec9"),a("3ca3"),a("ddb0"),a("fb6a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tabs-container",class:{"flex items-start":e.vertical}},[a("ul",{staticClass:"nav flex flex-col flex-wrap list-none border-b-0 pl-0 mb-3",class:{"md:flex-row":!e.vertical,"nav-tabs":!e.pills,"nav-pills":e.pills},attrs:{role:"tablist"}},e._l(e.titles,(function(t,r){return a("li",{key:r,staticClass:"nav-item",class:e.navItemClass,attrs:{role:"presentation"}},[a("a",{staticClass:"\n          nav-link\n          block\n          font-medium\n          text-xs\n          leading-tight\n          uppercase\n          border-x-0 border-t-0 border-b-2 border-transparent\n          px-6\n          py-3\n          my-2\n          cursor-pointer\n        ",class:{"pointer-events-none cursor-not-allowed":t.disabled,active:r===e.currentValue,"hover:border-transparent hover:bg-gray-100 focus:border-transparent":!e.pills,"focus:outline-none focus:ring-0 rounded":e.pills},attrs:{id:"tab-"+r,role:"tab","aria-selected":"true"},on:{click:function(t){e.currentValue=r}}},[e._v(" "+e._s(t.label||t)+" ")])])})),0),a("div",{staticClass:"tab-content"},e._l(e.titles.length,(function(t){return a("div",{key:t,staticClass:"tab-pane fade",class:{"show active":t-1===e.currentValue},attrs:{id:"tab-content-"+(t-1),role:"tabpanel"}},[e._t("tab-"+t)],2)})),0)])}),A=[],F=(a("a9e3"),{name:"teTabs",props:{value:{type:Number,default:0},titles:{type:Array,required:!0},filled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},pills:{type:Boolean,default:!1}},data:function(){return{currentValue:-1}},created:function(){this.currentValue=this.value},watch:{currentValue:function(e){this.$emit("input",e)},value:function(e){this.currentValue=e}},computed:{navItemClass:function(){return{"flex-auto text-center":this.filled,"flex-grow text-center":this.vertical,"mx-1":this.pills&&!this.vertical}}}}),E=F,T=Object(w["a"])(E,V,A,!1,null,null,null),$=T.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("select",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"form-select\n  appearance-none\n  block\n  w-full\n  font-normal\n  text-gray-700\n  bg-white bg-clip-padding bg-no-repeat\n  border border-solid border-gray-300\n  rounded\n  transition\n  ease-in-out\n  m-0\n  focus:text-gray-700\n  focus:bg-white\n  focus:border-blue-600\n  focus:outline-none",class:e.sizeClass,attrs:{disabled:e.disabled},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.currentValue=t.target.multiple?a:a[0]}}},[e.placeholder?a("option",{attrs:{value:"",selected:"",hidden:""}},[e._v(e._s(e.placeholder))]):e._e(),e._l(e.options,(function(t,r){return a("option",{key:r,domProps:{value:t[e.valueField]||t}},[e._v(" "+e._s(t[e.displayField]||t)+" ")])}))],2)},z=[],P={name:"teSelect",props:{value:{type:[String,Number,Array],default:null},options:{type:Array,default:function(){return[]}},displayField:{type:String,default:"label"},valueField:{type:String,default:"id"},placeholder:{type:String,default:""},size:{type:String,default:"medium",validator:function(e){return["small","medium","large"].includes(e)}},disabled:{type:Boolean,default:!1}},data:function(){return{currentValue:""}},created:function(){this.currentValue=this.value||""},computed:{sizeClass:function(){return{"px-x py-1 text-sm":"small"===this.size,"px-3 py-1.5 text-base":"medium"===this.size,"px-4 py-2 text-xl":"large"===this.size}}},watch:{currentValue:function(e){this.$emit("input",e)},value:function(e){this.currentValue=e}}},N=P,D=Object(w["a"])(N,B,z,!1,null,null,null),J=D.exports,M={components:{teTabs:$,teSelect:J},data:function(){return{headers:[{label:"Réponses",field:"answer"},{label:"=>",field:"button"},{label:"Renommage",field:"rename"}],headers_ind:[{label:"Réponses",field:"answer"},{label:"=>",field:"email"},{label:"Renommage",field:"id"}],cutoff:null}},computed:Object(R["a"])({},Object(c["c"])({data:"data",fields:"fields",questions:"questions",mappings:"mappings",errors:"errors",canUndo:"canUndo",canRedo:"canRedo"})),mounted:function(){this.cutoff=this.questions.length},methods:Object(R["a"])(Object(R["a"])({},Object(c["b"])(["undo","redo"])),{},{clear:function(){this.$store.dispatch("clear")},getGroupedRemaps:function(e){try{for(var t=this.mappings[e].reduce((function(e,t){if(t){var a=t.mapped;return Object.keys(e).includes(a)||(e[a]=0),e[a]+=1,e}}),{}),a=Object.entries(t).sort((function(e,t){var a=Object(q["a"])(e,2),r=a[1],n=Object(q["a"])(t,2),s=n[1];return s-r})).reduce((function(e,t){var a=Object(q["a"])(t,2),r=a[0],n=a[1];return Object(R["a"])(Object(R["a"])({},e),{},Object(S["a"])({},r,n))}),{}),r=[],n=0,s=Object.entries(a);n<s.length;n++){var i=s[n];r.push({mapped:i[0],count:i[1]})}return r}catch(o){return[]}},getDistinctAnswers:function(e){for(var t=this.mappings[e].reduce((function(e,t){if(t){var a=t.answer;return Object.keys(e).includes(a)||(e[a]=0),e[a]+=1,e}}),{}),a=Object.entries(t).sort((function(e,t){var a=Object(q["a"])(e,2),r=a[1],n=Object(q["a"])(t,2),s=n[1];return s-r})).reduce((function(e,t){var a=Object(q["a"])(t,2),r=a[0],n=a[1];return Object(R["a"])(Object(R["a"])({},e),{},Object(S["a"])({},r,n))}),{}),r=[],n=0,s=Object.entries(a);n<s.length;n++){var i=s[n];r.push({answer:i[0]})}return r.push({answer:"Disqualifié"}),r},getResults:function(e){var t=e+3,a=[],r=this.fields;for(var n in this.data){var s=this.data[n],i=[s[r[0]],s[r[1]],s[r[2]],s[r[t]]];void 0!==i[0]&&a.push(i)}return a},remap:function(e,t,a,r){var n={before:e,after:t,question:a,row:r};""!==t&&t!==e&&y.dispatch(m,n)},getScoresByAnswer:function(e){var t,a=this.getGroupedRemaps(e),r=[],n=Object(l["a"])(a);try{for(n.s();!(t=n.n()).done;){var s,i=t.value,o=i["mapped"],c=[],u=Object(l["a"])(this.mappings[e]);try{for(u.s();!(s=u.n()).done;){var p=s.value;p.mapped===o&&c.push({twitter:p["twitter"],email:p["email"]})}}catch(f){u.e(f)}finally{u.f()}var d=[o,c];r.push(d)}}catch(f){n.e(f)}finally{n.f()}return r},getScoresByUser:function(e){var t=new Map;for(var a in this.questions.slice(0,e)){var r,n=this.getScoresByAnswer(a),s=Object(l["a"])(n);try{for(s.s();!(r=s.n()).done;){var i,o=r.value,c=Object(l["a"])(o[1]);try{for(c.s();!(i=c.n()).done;){var u=i.value;t.has(u.twitter+u.email)||t.set(u.twitter+u.email,{email:u.email,twitter:u.twitter,score:0});var p=t.get(u.twitter+u.email);p.score+="Disqualifié"===o[0]?0:o[1].length,t.set(u.twitter+u.email,p)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){s.e(f)}finally{s.f()}}var d=Object(k["a"])(t.values());return d.sort((function(e,t){return t.score-e.score})),d}})},I=M,U=(a("2c71"),Object(w["a"])(I,O,j,!1,null,null,null)),G=U.exports,Q={name:"App",components:{TextReader:C,Shearing:G}},L=Q,Z=(a("ce48"),Object(w["a"])(L,n,s,!1,null,"f0018c16",null)),H=Z.exports,K=a("f751"),W=(a("acb8"),a("3717")),X=a.n(W);r["a"].use(K["a"]),r["a"].use(X.a),r["a"].config.productionTip=!1,new r["a"]({store:y,render:function(e){return e(H)}}).$mount("#app")},"57c1":function(e,t,a){},"80bc":function(e,t,a){},b4fa:function(e,t,a){"use strict";a("80bc")},ce48:function(e,t,a){"use strict";a("e447")},e447:function(e,t,a){}});
//# sourceMappingURL=app.e537ac3e.js.map